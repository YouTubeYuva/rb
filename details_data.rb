data = [{"id":1,"first_name":"Jerad","last_name":"Hourston","email":"jhourston0@bloomberg.com","gender":"Male","ip_address":"21.4.141.43"},
{"id":2,"first_name":"Jed","last_name":"Seine","email":"jseine1@abc.net.au","gender":"Male","ip_address":"123.19.56.165"},
{"id":3,"first_name":"Lorelle","last_name":"Weakley","email":"lweakley2@xing.com","gender":"Female","ip_address":"248.112.174.183"},
{"id":4,"first_name":"Wallace","last_name":"Andino","email":"wandino3@microsoft.com","gender":"Male","ip_address":"146.160.5.187"},
{"id":5,"first_name":"Arel","last_name":"Llopis","email":"allopis4@chronoengine.com","gender":"Male","ip_address":"139.183.20.207"},
{"id":6,"first_name":"Sianna","last_name":"Petrushkevich","email":"spetrushkevich5@reuters.com","gender":"Female","ip_address":"62.23.63.146"},
{"id":7,"first_name":"Keane","last_name":"Blewett","email":"kblewett6@twitter.com","gender":"Male","ip_address":"243.100.43.215"},
{"id":8,"first_name":"Sabina","last_name":"Schustl","email":"sschustl7@reference.com","gender":"Female","ip_address":"58.211.13.232"},
{"id":9,"first_name":"Keene","last_name":"Morehall","email":"kmorehall8@nsw.gov.au","gender":"Male","ip_address":"213.8.77.142"},
{"id":10,"first_name":"Ignatius","last_name":"Bruntje","email":"ibruntje9@hp.com","gender":"Male","ip_address":"131.63.26.209"},
{"id":11,"first_name":"Barney","last_name":"Kinker","email":"bkinkera@princeton.edu","gender":"Male","ip_address":"29.212.145.192"},
{"id":12,"first_name":"Sancho","last_name":"Bartlomiejczyk","email":"sbartlomiejczykb@homestead.com","gender":"Male","ip_address":"147.69.95.251"},
{"id":13,"first_name":"Zaneta","last_name":"Hearnes","email":"zhearnesc@sciencedaily.com","gender":"Female","ip_address":"72.176.92.233"},
{"id":14,"first_name":"Bobbie","last_name":"O'Mahoney","email":"bomahoneyd@comsenz.com","gender":"Female","ip_address":"36.77.47.200"},
{"id":15,"first_name":"Wayland","last_name":"Wankel","email":"wwankele@un.org","gender":"Male","ip_address":"230.122.230.215"},
{"id":16,"first_name":"Jacquenette","last_name":"Bettenay","email":"jbettenayf@angelfire.com","gender":"Female","ip_address":"178.136.96.201"},
{"id":17,"first_name":"Andria","last_name":"Westrope","email":"awestropeg@dedecms.com","gender":"Female","ip_address":"136.142.135.112"},
{"id":18,"first_name":"Lalo","last_name":"Ferriday","email":"lferridayh@sitemeter.com","gender":"Male","ip_address":"194.95.172.195"},
{"id":19,"first_name":"Ephraim","last_name":"Inchboard","email":"einchboardi@ehow.com","gender":"Male","ip_address":"183.175.70.139"},
{"id":20,"first_name":"Addy","last_name":"Leithgoe","email":"aleithgoej@clickbank.net","gender":"Male","ip_address":"13.115.18.136"},
{"id":21,"first_name":"Reynard","last_name":"Karlowicz","email":"rkarlowiczk@photobucket.com","gender":"Male","ip_address":"189.38.116.54"},
{"id":22,"first_name":"Shane","last_name":"Cutchey","email":"scutcheyl@etsy.com","gender":"Male","ip_address":"164.18.41.187"},
{"id":23,"first_name":"Ellyn","last_name":"Cavanaugh","email":"ecavanaughm@chron.com","gender":"Female","ip_address":"85.197.225.176"},
{"id":24,"first_name":"Brantley","last_name":"Rothman","email":"brothmann@independent.co.uk","gender":"Male","ip_address":"214.134.59.254"},
{"id":25,"first_name":"Murvyn","last_name":"Burston","email":"mburstono@wikispaces.com","gender":"Male","ip_address":"173.27.87.151"},
{"id":26,"first_name":"Matias","last_name":"Wilmot","email":"mwilmotp@4shared.com","gender":"Male","ip_address":"8.6.190.221"},
{"id":27,"first_name":"Hoebart","last_name":"Headingham","email":"hheadinghamq@telegraph.co.uk","gender":"Male","ip_address":"185.13.121.232"},
{"id":28,"first_name":"Theo","last_name":"Chipperfield","email":"tchipperfieldr@ning.com","gender":"Male","ip_address":"154.181.218.216"},
{"id":29,"first_name":"Towney","last_name":"de Aguirre","email":"tdeaguirres@artisteer.com","gender":"Male","ip_address":"154.53.139.151"},
{"id":30,"first_name":"Gorden","last_name":"Bartkowiak","email":"gbartkowiakt@admin.ch","gender":"Male","ip_address":"19.134.200.79"},
{"id":31,"first_name":"Orelee","last_name":"Bechley","email":"obechleyu@goo.gl","gender":"Female","ip_address":"135.132.177.247"},
{"id":32,"first_name":"Mag","last_name":"De Simoni","email":"mdesimoniv@time.com","gender":"Female","ip_address":"122.50.1.76"},
{"id":33,"first_name":"Norbert","last_name":"Fennelow","email":"nfenneloww@istockphoto.com","gender":"Male","ip_address":"79.95.106.234"},
{"id":34,"first_name":"Herman","last_name":"Colebeck","email":"hcolebeckx@deliciousdays.com","gender":"Male","ip_address":"74.244.155.31"},
{"id":35,"first_name":"Eadmund","last_name":"Manntschke","email":"emanntschkey@ftc.gov","gender":"Male","ip_address":"133.54.56.129"},
{"id":36,"first_name":"Ermin","last_name":"Hargie","email":"ehargiez@webnode.com","gender":"Male","ip_address":"144.137.60.60"},
{"id":37,"first_name":"Meg","last_name":"Raddin","email":"mraddin10@dyndns.org","gender":"Female","ip_address":"95.128.26.190"},
{"id":38,"first_name":"Mac","last_name":"Adamovitch","email":"madamovitch11@creativecommons.org","gender":"Polygender","ip_address":"0.14.121.172"},
{"id":39,"first_name":"Estella","last_name":"Starrs","email":"estarrs12@ibm.com","gender":"Female","ip_address":"158.108.101.211"},
{"id":40,"first_name":"Marshal","last_name":"Mottley","email":"mmottley13@un.org","gender":"Male","ip_address":"202.57.78.152"},
{"id":41,"first_name":"Rutledge","last_name":"Bethel","email":"rbethel14@topsy.com","gender":"Male","ip_address":"27.135.226.170"},
{"id":42,"first_name":"Hildegarde","last_name":"Riall","email":"hriall15@angelfire.com","gender":"Female","ip_address":"226.250.73.65"},
{"id":43,"first_name":"Izak","last_name":"Farman","email":"ifarman16@imdb.com","gender":"Male","ip_address":"17.252.182.59"},
{"id":44,"first_name":"Amelina","last_name":"Robottham","email":"arobottham17@economist.com","gender":"Female","ip_address":"150.242.203.145"},
{"id":45,"first_name":"Roscoe","last_name":"MacVanamy","email":"rmacvanamy18@github.io","gender":"Male","ip_address":"190.5.155.96"},
{"id":46,"first_name":"Peter","last_name":"Medina","email":"pmedina19@sciencedirect.com","gender":"Male","ip_address":"222.158.13.8"},
{"id":47,"first_name":"Buddie","last_name":"Kingsman","email":"bkingsman1a@eventbrite.com","gender":"Male","ip_address":"244.162.228.16"},
{"id":48,"first_name":"Jenilee","last_name":"Kyndred","email":"jkyndred1b@tumblr.com","gender":"Genderqueer","ip_address":"43.88.164.41"},
{"id":49,"first_name":"Filia","last_name":"Baumer","email":"fbaumer1c@go.com","gender":"Bigender","ip_address":"214.255.119.30"},
{"id":50,"first_name":"Zondra","last_name":"Glander","email":"zglander1d@eventbrite.com","gender":"Female","ip_address":"200.38.179.113"},
{"id":51,"first_name":"Virgil","last_name":"Fadian","email":"vfadian1e@seesaa.net","gender":"Male","ip_address":"44.76.37.136"},
{"id":52,"first_name":"Colby","last_name":"Whitemarsh","email":"cwhitemarsh1f@yelp.com","gender":"Male","ip_address":"15.105.155.51"},
{"id":53,"first_name":"Mignon","last_name":"Lorenzo","email":"mlorenzo1g@free.fr","gender":"Genderfluid","ip_address":"157.149.113.157"},
{"id":54,"first_name":"Farrel","last_name":"McKendo","email":"fmckendo1h@imdb.com","gender":"Male","ip_address":"48.238.132.71"},
{"id":55,"first_name":"Berkeley","last_name":"Roscrigg","email":"broscrigg1i@google.com","gender":"Male","ip_address":"49.22.156.252"},
{"id":56,"first_name":"Mildrid","last_name":"Bearsmore","email":"mbearsmore1j@phoca.cz","gender":"Female","ip_address":"154.73.3.193"},
{"id":57,"first_name":"Poppy","last_name":"Pinnock","email":"ppinnock1k@wired.com","gender":"Female","ip_address":"124.104.173.117"},
{"id":58,"first_name":"Dalton","last_name":"MacSwayde","email":"dmacswayde1l@infoseek.co.jp","gender":"Non-binary","ip_address":"23.26.108.207"},
{"id":59,"first_name":"Janie","last_name":"Bamforth","email":"jbamforth1m@hhs.gov","gender":"Female","ip_address":"183.78.201.120"},
{"id":60,"first_name":"Cathe","last_name":"Neil","email":"cneil1n@omniture.com","gender":"Genderqueer","ip_address":"144.155.13.158"},
{"id":61,"first_name":"Solly","last_name":"McQuillin","email":"smcquillin1o@mozilla.org","gender":"Male","ip_address":"252.123.207.109"},
{"id":62,"first_name":"Vivie","last_name":"Isacoff","email":"visacoff1p@boston.com","gender":"Female","ip_address":"186.38.112.78"},
{"id":63,"first_name":"Baron","last_name":"Cleft","email":"bcleft1q@livejournal.com","gender":"Male","ip_address":"214.246.249.238"},
{"id":64,"first_name":"Ripley","last_name":"Warland","email":"rwarland1r@google.pl","gender":"Male","ip_address":"33.213.62.158"},
{"id":65,"first_name":"Boot","last_name":"Argente","email":"bargente1s@smugmug.com","gender":"Male","ip_address":"214.209.174.96"},
{"id":66,"first_name":"Free","last_name":"Jeanet","email":"fjeanet1t@howstuffworks.com","gender":"Male","ip_address":"35.128.115.183"},
{"id":67,"first_name":"Swen","last_name":"Aldersley","email":"saldersley1u@bluehost.com","gender":"Male","ip_address":"186.236.110.87"},
{"id":68,"first_name":"Teddi","last_name":"Dutton","email":"tdutton1v@cnet.com","gender":"Female","ip_address":"11.12.4.41"},
{"id":69,"first_name":"Violante","last_name":"Tungate","email":"vtungate1w@github.com","gender":"Female","ip_address":"189.244.115.251"},
{"id":70,"first_name":"Courtnay","last_name":"Scardifeild","email":"cscardifeild1x@dyndns.org","gender":"Male","ip_address":"81.235.233.247"},
{"id":71,"first_name":"Hewe","last_name":"Plaistowe","email":"hplaistowe1y@webnode.com","gender":"Male","ip_address":"172.138.146.125"},
{"id":72,"first_name":"Dulcie","last_name":"Walsh","email":"dwalsh1z@google.nl","gender":"Female","ip_address":"196.121.84.25"},
{"id":73,"first_name":"Thurston","last_name":"Yokelman","email":"tyokelman20@wired.com","gender":"Male","ip_address":"218.184.31.24"},
{"id":74,"first_name":"Breanne","last_name":"Jorin","email":"bjorin21@sogou.com","gender":"Female","ip_address":"78.30.96.193"},
{"id":75,"first_name":"Waly","last_name":"Cremin","email":"wcremin22@odnoklassniki.ru","gender":"Female","ip_address":"200.12.22.142"},
{"id":76,"first_name":"Daloris","last_name":"Mollitt","email":"dmollitt23@google.de","gender":"Female","ip_address":"150.55.112.30"},
{"id":77,"first_name":"Venita","last_name":"Ferencowicz","email":"vferencowicz24@unesco.org","gender":"Female","ip_address":"242.17.229.90"},
{"id":78,"first_name":"Josefa","last_name":"Troman","email":"jtroman25@spiegel.de","gender":"Female","ip_address":"103.2.233.17"},
{"id":79,"first_name":"Orton","last_name":"Orro","email":"oorro26@dailymail.co.uk","gender":"Male","ip_address":"208.165.157.132"},
{"id":80,"first_name":"Miles","last_name":"Janout","email":"mjanout27@adobe.com","gender":"Male","ip_address":"167.172.106.228"},
{"id":81,"first_name":"Katheryn","last_name":"Skeates","email":"kskeates28@dropbox.com","gender":"Female","ip_address":"120.19.151.4"},
{"id":82,"first_name":"Emma","last_name":"Trenfield","email":"etrenfield29@thetimes.co.uk","gender":"Female","ip_address":"92.175.1.172"},
{"id":83,"first_name":"Haleigh","last_name":"Birdfield","email":"hbirdfield2a@harvard.edu","gender":"Male","ip_address":"206.65.47.148"},
{"id":84,"first_name":"Ernest","last_name":"Espinosa","email":"eespinosa2b@privacy.gov.au","gender":"Male","ip_address":"187.197.18.240"},
{"id":85,"first_name":"Klaus","last_name":"Griffen","email":"kgriffen2c@free.fr","gender":"Male","ip_address":"248.25.31.129"},
{"id":86,"first_name":"Eduardo","last_name":"Sleford","email":"esleford2d@pinterest.com","gender":"Non-binary","ip_address":"21.146.60.114"},
{"id":87,"first_name":"Odelle","last_name":"Swindells","email":"oswindells2e@desdev.cn","gender":"Female","ip_address":"50.229.108.68"},
{"id":88,"first_name":"Richart","last_name":"Saiens","email":"rsaiens2f@usgs.gov","gender":"Male","ip_address":"123.46.239.64"},
{"id":89,"first_name":"Kynthia","last_name":"Kee","email":"kkee2g@blinklist.com","gender":"Female","ip_address":"13.157.243.172"},
{"id":90,"first_name":"Cheslie","last_name":"Jakubovicz","email":"cjakubovicz2h@tinypic.com","gender":"Genderqueer","ip_address":"11.9.200.109"},
{"id":91,"first_name":"Forrest","last_name":"Beden","email":"fbeden2i@ihg.com","gender":"Male","ip_address":"244.129.236.171"},
{"id":92,"first_name":"Garrot","last_name":"Alen","email":"galen2j@ucsd.edu","gender":"Male","ip_address":"71.91.170.64"},
{"id":93,"first_name":"Mignonne","last_name":"Wilshere","email":"mwilshere2k@ow.ly","gender":"Female","ip_address":"131.134.152.26"},
{"id":94,"first_name":"Garvey","last_name":"Lafaye","email":"glafaye2l@shinystat.com","gender":"Male","ip_address":"163.194.21.92"},
{"id":95,"first_name":"Duncan","last_name":"Lowne","email":"dlowne2m@hc360.com","gender":"Male","ip_address":"174.168.70.231"},
{"id":96,"first_name":"Jillayne","last_name":"Bukowski","email":"jbukowski2n@army.mil","gender":"Female","ip_address":"4.41.64.8"},
{"id":97,"first_name":"Silvanus","last_name":"Canada","email":"scanada2o@icq.com","gender":"Male","ip_address":"251.79.113.2"},
{"id":98,"first_name":"Roxie","last_name":"Bernardos","email":"rbernardos2p@archive.org","gender":"Genderfluid","ip_address":"214.191.2.208"},
{"id":99,"first_name":"Roby","last_name":"Metzel","email":"rmetzel2q@youku.com","gender":"Female","ip_address":"255.112.51.84"},
{"id":100,"first_name":"Flori","last_name":"Dugall","email":"fdugall2r@furl.net","gender":"Female","ip_address":"86.143.118.240"}]

#1. count users by gender
print data.map{|element| element[:gender]}.count

#2. Find user by email
def detail(emails,data)
    user = data.find{|element| element[:email] == emails}
    if user.nil?
        puts "No matching email found."
    end 
    user
end 
print details = detail("fdugall2r@furl.net",data)

#3. list unique ip_address
print data.map{|element| element[:ip_address]}.uniq

#4. Filter users by gender
users_by_gender =  data.group_by{|element| element[:gender]}.each_with_object({}) do |(genders,details), hash|
    hash[genders] = details.map{ |element| element[:first_name]}
end
print users_by_gender

#5. Find user with longest Email
print longest_email = data.max_by{|element| element[:email].length}[:email]
user_with_longest_email = data.find{|element| element[:email] == longest_email}
print ({user_with_longest_email[:first_name] => longest_email})

#6. Count users with specific ip pattern
ip_pattern_users = data.select { |element| element[:ip_address].start_with?("21.4.") }
result = ip_pattern_users.each_with_object({}) do |element, hash|
   hash[element[:ip_address]] = element[:first_name]
end
print result

#7. Sort users by last name 
print data.sort_by{|element| element[:last_name]}

#8. Group users by gender
print data.group_by{|element| element[:gender]}

#9. Find user by ip_address
def detail(ip_address,data)
    user = data.find{|element| element[:ip_address] == ip_address }
    if user.nil?
        puts "No matching ip address found. "
    end 
    user
end
print details = detail("251.79.113.2",data)

#10. Generate user email domains
data.each { |details| details[:domain] = details[:email].split('@').last}
print data
  
# 11.Find Users with missing email domains
missing_domains = data.select do |element|
    !element[:email].include?('@') || element[:email].split('@').last.empty?
end
print missing_domains

#12. Detect duplicate ip_address
 ip_address = data.map { |user| user[:ip_address] }
duplicate =ip_address.select { |ip| ip_address.count(ip) > 1}.uniq
print duplicate

# 13. Count Users by Domain Extension   
domain_extensions = data.map{|element| element[:email].split('@').last.split('.').last}
print domain_extensions.each_with_object(Hash.new(0)) { |element, hash| hash[element] += 1}

#14. Find most common ip_address 
ip_perfixes = data.map { |user| user[:ip_address].split(".").first}
print  ip_perfixes.tally.max_by{|ip_addres,counts| counts }

#15. List users with common email domains
email_domains = data.map { |element | element [:email].split('@').last }
domain_counts = email_domains.tally
print most_common_domains = domain_counts.select { |domain_count, counts| counts == domain_counts.values.max}
 print most_common_domains

#16. Find users with ip_address containing a specific pattern
def detail(ip_addres,data)
    user = data.find{|element| element[:ip_address] == ip_addres}
        if user.nil?
            puts "No matching email found."
        end 
        user
    end 
print details = detail("86.143.118.240",data)

#17. Group users by gender and count each group
users_by_gender =  data.group_by{|element| element[:gender]}.each_with_object({}) do |(genders,details), hash|
    hash[genders] = details.map{ |element| element[:first_name]}.count
end
print users_by_gender

#18. Identify users with short email domains 
print data.min_by{|x| x[:email].split("@").last.length}[:first_name]

#19. Find the user with the highest numerical ip address
print data.max_by{|x| x[:ip_address].split(".").join().to_i}[:first_name]


